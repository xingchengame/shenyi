import{j as o,h as I}from"./codemirror-core-DIzFijqu.js";import{k as Ir,b as jn,P as To,r as ct,q as Po,v as Ao,x as So,y as Eo,z as Co}from"./index-B0DyBq9P.js";import{J as en,C as ut,u as De,c as H}from"./react-dom-TsCL3mk_.js";import{i as Uo,j as ko,k as Mo,c as Lo,l as Ko}from"./index-CtZU_f5P.js";import{T as Bo,a as Do,b as zo,C as at,c as ht,d as _o}from"./code_editor--lSn7AvI.js";import{i as yr}from"./chunk-2QAN2V2R-DjiYH11d.js";import{p as qo,a as Vo,b as Ho}from"./chunk-2QQAR2RD-C6SUFd_i.js";import{t as _e}from"./chunk-6LIX6LVT-v4ufXNaW.js";import{t as Wo,a as ft}from"./chunk-ML27DD5T-CMfbU3IH.js";import{c as Fe}from"./chunk-NAV3ZXLI-VwA3667I.js";import{C as Jo}from"./modal-CZlb9vmt.js";import"./iconBase-ClXMXqAg.js";import"./codemirror-lang-9foHeFXi.js";import"./chunk-CAFRINWI-CcU5yOMx.js";import"./chunk-SLABUSGS-BX9EgnNv.js";import"./chunk-M3MASYO7-BtOvSeRL.js";import"./chunk-WQVQ7P2I-B4KcTpLM.js";import"./chunk-FGM523TA-1yNCP0SW.js";import"./chunk-KVDW62ZT-CdlHxaox.js";import"./Item-DvdRZmps.js";import"./chunk-AXSF7SRE-xAGcR_TS.js";import"./index-CokAva9Y.js";import"./_baseIsEqual-DpqT7ENi.js";import"./use-dialog-CRavAmtS.js";import"./index-DhICtZLt.js";import"./index-DYKlz1bo.js";import"./index-3atF2w48.js";import"./chunk-MLPFQTYO-6EVO19Sj.js";import"./qface-CqvgXw72.js";import"./index-CZV_7wPI.js";import"./react-hook-form-D03iFOdR.js";let dt={};async function Go(){try{const e=await(await fetch("/api/Debug/schemas",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();if(e.code===0)return dt=e.data,dt}catch(n){console.error("Failed to fetch OneBot HTTP API schemas:",n)}return{}}function Yo(n){return M(n)&&!nn(n)&&!Re(n)&&Symbol.asyncIterator in n}function nn(n){return Array.isArray(n)}function Rt(n){return typeof n=="bigint"}function he(n){return typeof n=="boolean"}function Rr(n){return n instanceof globalThis.Date}function Xo(n){return typeof n=="function"}function Qo(n){return M(n)&&!nn(n)&&!Re(n)&&Symbol.iterator in n}function Zo(n){return n===null}function On(n){return typeof n=="number"}function M(n){return typeof n=="object"&&n!==null}function Nt(n){return n instanceof globalThis.RegExp}function C(n){return typeof n=="string"}function vo(n){return typeof n=="symbol"}function Re(n){return n instanceof globalThis.Uint8Array}function U(n){return n===void 0}function ns(n){return n.map(e=>qe(e))}function es(n){return new Date(n.getTime())}function rs(n){return new Uint8Array(n)}function ts(n){return new RegExp(n.source,n.flags)}function os(n){const e={};for(const r of Object.getOwnPropertyNames(n))e[r]=qe(n[r]);for(const r of Object.getOwnPropertySymbols(n))e[r]=qe(n[r]);return e}function qe(n){return nn(n)?ns(n):Rr(n)?es(n):Re(n)?rs(n):Nt(n)?ts(n):M(n)?os(n):n}function rn(n){return qe(n)}function Nr(n,e){return rn(e===void 0?n:{...e,...n})}function ss(n){return n!==null&&typeof n=="object"}function is(n){return globalThis.Array.isArray(n)&&!globalThis.ArrayBuffer.isView(n)}function cs(n){return n===void 0}function us(n){return typeof n=="number"}var Or;(function(n){n.InstanceMode="default",n.ExactOptionalPropertyTypes=!1,n.AllowArrayObject=!1,n.AllowNaN=!1,n.AllowNullVoid=!1;function e(u,d){return n.ExactOptionalPropertyTypes?d in u:u[d]!==void 0}n.IsExactOptionalProperty=e;function r(u){const d=ss(u);return n.AllowArrayObject?d:d&&!is(u)}n.IsObjectLike=r;function t(u){return r(u)&&!(u instanceof Date)&&!(u instanceof Uint8Array)}n.IsRecordLike=t;function i(u){return n.AllowNaN?us(u):Number.isFinite(u)}n.IsNumberLike=i;function a(u){const d=cs(u);return n.AllowNullVoid?d||u===null:d}n.IsVoidLike=a})(Or||(Or={}));function as(n){return globalThis.Object.freeze(n).map(e=>Ve(e))}function fs(n){const e={};for(const r of Object.getOwnPropertyNames(n))e[r]=Ve(n[r]);for(const r of Object.getOwnPropertySymbols(n))e[r]=Ve(n[r]);return globalThis.Object.freeze(e)}function Ve(n){return nn(n)?as(n):Rr(n)?n:Re(n)?n:Nt(n)?n:M(n)?fs(n):n}function c(n,e){const r=e!==void 0?{...e,...n}:n;switch(Or.InstanceMode){case"freeze":return Ve(r);case"clone":return rn(r);default:return r}}class Dn extends Error{constructor(e){super(e)}}const fn=Symbol.for("TypeBox.Transform"),Ne=Symbol.for("TypeBox.Readonly"),Rn=Symbol.for("TypeBox.Optional"),Ge=Symbol.for("TypeBox.Hint"),f=Symbol.for("TypeBox.Kind");function Tr(n){return M(n)&&n[Ne]==="Readonly"}function An(n){return M(n)&&n[Rn]==="Optional"}function Tt(n){return b(n,"Any")}function Pt(n){return b(n,"Argument")}function re(n){return b(n,"Array")}function Ye(n){return b(n,"AsyncIterator")}function Xe(n){return b(n,"BigInt")}function Te(n){return b(n,"Boolean")}function te(n){return b(n,"Computed")}function oe(n){return b(n,"Constructor")}function ds(n){return b(n,"Date")}function se(n){return b(n,"Function")}function ie(n){return b(n,"Integer")}function ln(n){return b(n,"Intersect")}function Qe(n){return b(n,"Iterator")}function b(n,e){return M(n)&&f in n&&n[f]===e}function At(n){return he(n)||On(n)||C(n)}function zn(n){return b(n,"Literal")}function _n(n){return b(n,"MappedKey")}function sn(n){return b(n,"MappedResult")}function Pe(n){return b(n,"Never")}function ls(n){return b(n,"Not")}function Pr(n){return b(n,"Null")}function ce(n){return b(n,"Number")}function yn(n){return b(n,"Object")}function Ze(n){return b(n,"Promise")}function ve(n){return b(n,"Record")}function Z(n){return b(n,"Ref")}function St(n){return b(n,"RegExp")}function Ae(n){return b(n,"String")}function Ar(n){return b(n,"Symbol")}function qn(n){return b(n,"TemplateLiteral")}function ms(n){return b(n,"This")}function nr(n){return M(n)&&fn in n}function Vn(n){return b(n,"Tuple")}function Sr(n){return b(n,"Undefined")}function V(n){return b(n,"Union")}function ps(n){return b(n,"Uint8Array")}function xs(n){return b(n,"Unknown")}function bs(n){return b(n,"Unsafe")}function Fs(n){return b(n,"Void")}function Is(n){return M(n)&&f in n&&C(n[f])}function Pn(n){return Tt(n)||Pt(n)||re(n)||Te(n)||Xe(n)||Ye(n)||te(n)||oe(n)||ds(n)||se(n)||ie(n)||ln(n)||Qe(n)||zn(n)||_n(n)||sn(n)||Pe(n)||ls(n)||Pr(n)||ce(n)||yn(n)||Ze(n)||ve(n)||Z(n)||St(n)||Ae(n)||Ar(n)||qn(n)||ms(n)||Vn(n)||Sr(n)||V(n)||ps(n)||xs(n)||bs(n)||Fs(n)||Is(n)}const ys=["Argument","Any","Array","AsyncIterator","BigInt","Boolean","Computed","Constructor","Date","Enum","Function","Integer","Intersect","Iterator","Literal","MappedKey","MappedResult","Not","Null","Number","Object","Promise","Record","Ref","RegExp","String","Symbol","TemplateLiteral","This","Tuple","Undefined","Union","Uint8Array","Unknown","Void"];function Et(n){try{return new RegExp(n),!0}catch{return!1}}function Er(n){if(!C(n))return!1;for(let e=0;e<n.length;e++){const r=n.charCodeAt(e);if(r>=7&&r<=13||r===27||r===127)return!1}return!0}function Ct(n){return Cr(n)||J(n)}function xe(n){return U(n)||Rt(n)}function R(n){return U(n)||On(n)}function Cr(n){return U(n)||he(n)}function j(n){return U(n)||C(n)}function Os(n){return U(n)||C(n)&&Er(n)&&Et(n)}function $s(n){return U(n)||C(n)&&Er(n)}function Ut(n){return U(n)||J(n)}function He(n){return M(n)&&n[Rn]==="Optional"}function xn(n){return F(n,"Any")&&j(n.$id)}function gs(n){return F(n,"Argument")&&On(n.index)}function Hn(n){return F(n,"Array")&&n.type==="array"&&j(n.$id)&&J(n.items)&&R(n.minItems)&&R(n.maxItems)&&Cr(n.uniqueItems)&&Ut(n.contains)&&R(n.minContains)&&R(n.maxContains)}function Ur(n){return F(n,"AsyncIterator")&&n.type==="AsyncIterator"&&j(n.$id)&&J(n.items)}function er(n){return F(n,"BigInt")&&n.type==="bigint"&&j(n.$id)&&xe(n.exclusiveMaximum)&&xe(n.exclusiveMinimum)&&xe(n.maximum)&&xe(n.minimum)&&xe(n.multipleOf)}function Wn(n){return F(n,"Boolean")&&n.type==="boolean"&&j(n.$id)}function js(n){return F(n,"Computed")&&C(n.target)&&nn(n.parameters)&&n.parameters.every(e=>J(e))}function rr(n){return F(n,"Constructor")&&n.type==="Constructor"&&j(n.$id)&&nn(n.parameters)&&n.parameters.every(e=>J(e))&&J(n.returns)}function tr(n){return F(n,"Date")&&n.type==="Date"&&j(n.$id)&&R(n.exclusiveMaximumTimestamp)&&R(n.exclusiveMinimumTimestamp)&&R(n.maximumTimestamp)&&R(n.minimumTimestamp)&&R(n.multipleOfTimestamp)}function or(n){return F(n,"Function")&&n.type==="Function"&&j(n.$id)&&nn(n.parameters)&&n.parameters.every(e=>J(e))&&J(n.returns)}function Nn(n){return F(n,"Integer")&&n.type==="integer"&&j(n.$id)&&R(n.exclusiveMaximum)&&R(n.exclusiveMinimum)&&R(n.maximum)&&R(n.minimum)&&R(n.multipleOf)}function kt(n){return M(n)&&Object.entries(n).every(([e,r])=>Er(e)&&J(r))}function Jn(n){return F(n,"Intersect")&&!(C(n.type)&&n.type!=="object")&&nn(n.allOf)&&n.allOf.every(e=>J(e)&&!Ps(e))&&j(n.type)&&(Cr(n.unevaluatedProperties)||Ut(n.unevaluatedProperties))&&j(n.$id)}function kr(n){return F(n,"Iterator")&&n.type==="Iterator"&&j(n.$id)&&J(n.items)}function F(n,e){return M(n)&&f in n&&n[f]===e}function Mt(n){return Sn(n)&&C(n.const)}function Lt(n){return Sn(n)&&On(n.const)}function Kt(n){return Sn(n)&&he(n.const)}function Sn(n){return F(n,"Literal")&&j(n.$id)&&ws(n.const)}function ws(n){return he(n)||On(n)||C(n)}function hs(n){return F(n,"MappedKey")&&nn(n.keys)&&n.keys.every(e=>On(e)||C(e))}function Rs(n){return F(n,"MappedResult")&&kt(n.properties)}function En(n){return F(n,"Never")&&M(n.not)&&Object.getOwnPropertyNames(n.not).length===0}function Zn(n){return F(n,"Not")&&J(n.not)}function Mr(n){return F(n,"Null")&&n.type==="null"&&j(n.$id)}function Q(n){return F(n,"Number")&&n.type==="number"&&j(n.$id)&&R(n.exclusiveMaximum)&&R(n.exclusiveMinimum)&&R(n.maximum)&&R(n.minimum)&&R(n.multipleOf)}function P(n){return F(n,"Object")&&n.type==="object"&&j(n.$id)&&kt(n.properties)&&Ct(n.additionalProperties)&&R(n.minProperties)&&R(n.maxProperties)}function Lr(n){return F(n,"Promise")&&n.type==="Promise"&&j(n.$id)&&J(n.item)}function W(n){return F(n,"Record")&&n.type==="object"&&j(n.$id)&&Ct(n.additionalProperties)&&M(n.patternProperties)&&(e=>{const r=Object.getOwnPropertyNames(e.patternProperties);return r.length===1&&Et(r[0])&&M(e.patternProperties)&&J(e.patternProperties[r[0]])})(n)}function Ns(n){return F(n,"Ref")&&j(n.$id)&&C(n.$ref)}function Ie(n){return F(n,"RegExp")&&j(n.$id)&&C(n.source)&&C(n.flags)&&R(n.maxLength)&&R(n.minLength)}function bn(n){return F(n,"String")&&n.type==="string"&&j(n.$id)&&R(n.minLength)&&R(n.maxLength)&&Os(n.pattern)&&$s(n.format)}function ye(n){return F(n,"Symbol")&&n.type==="symbol"&&j(n.$id)}function Oe(n){return F(n,"TemplateLiteral")&&n.type==="string"&&C(n.pattern)&&n.pattern[0]==="^"&&n.pattern[n.pattern.length-1]==="$"}function Ts(n){return F(n,"This")&&j(n.$id)&&C(n.$ref)}function Ps(n){return M(n)&&fn in n}function sr(n){return F(n,"Tuple")&&n.type==="array"&&j(n.$id)&&On(n.minItems)&&On(n.maxItems)&&n.minItems===n.maxItems&&(U(n.items)&&U(n.additionalItems)&&n.minItems===0||nn(n.items)&&n.items.every(e=>J(e)))}function Kn(n){return F(n,"Undefined")&&n.type==="undefined"&&j(n.$id)}function hn(n){return F(n,"Union")&&j(n.$id)&&M(n)&&nn(n.anyOf)&&n.anyOf.every(e=>J(e))}function Se(n){return F(n,"Uint8Array")&&n.type==="Uint8Array"&&j(n.$id)&&R(n.minByteLength)&&R(n.maxByteLength)}function Fn(n){return F(n,"Unknown")&&j(n.$id)}function As(n){return F(n,"Unsafe")}function ir(n){return F(n,"Void")&&n.type==="void"&&j(n.$id)}function Ss(n){return M(n)&&f in n&&C(n[f])&&!ys.includes(n[f])}function J(n){return M(n)&&(xn(n)||gs(n)||Hn(n)||Wn(n)||er(n)||Ur(n)||js(n)||rr(n)||tr(n)||or(n)||Nn(n)||Jn(n)||kr(n)||Sn(n)||hs(n)||Rs(n)||En(n)||Zn(n)||Mr(n)||Q(n)||P(n)||Lr(n)||W(n)||Ns(n)||Ie(n)||bn(n)||ye(n)||Oe(n)||Ts(n)||sr(n)||Kn(n)||hn(n)||Se(n)||Fn(n)||As(n)||ir(n)||Ss(n))}const Es="(true|false)",ze="(0|[1-9][0-9]*)",Bt="(.*)",Cs="(?!.*)",vn=`^${ze}$`,ne=`^${Bt}$`,Us=`^${Cs}$`;function ks(n,e){return n.includes(e)}function Ms(n){return[...new Set(n)]}function Ls(n,e){return n.filter(r=>e.includes(r))}function Ks(n,e){return n.reduce((r,t)=>Ls(r,t),e)}function Bs(n){return n.length===1?n[0]:n.length>1?Ks(n.slice(1),n[0]):[]}function Ds(n){const e=[];for(const r of n)e.push(...r);return e}function $e(n){return c({[f]:"Any"},n)}function Kr(n,e){return c({[f]:"Array",type:"array",items:n},e)}function zs(n){return c({[f]:"Argument",index:n})}function Br(n,e){return c({[f]:"AsyncIterator",type:"AsyncIterator",items:n},e)}function z(n,e,r){return c({[f]:"Computed",target:n,parameters:e},r)}function _s(n,e){const{[e]:r,...t}=n;return t}function tn(n,e){return e.reduce((r,t)=>_s(r,t),n)}function L(n){return c({[f]:"Never",not:{}},n)}function G(n){return c({[f]:"MappedResult",properties:n})}function Dr(n,e,r){return c({[f]:"Constructor",type:"Constructor",parameters:n,returns:e},r)}function Ee(n,e,r){return c({[f]:"Function",type:"Function",parameters:n,returns:e},r)}function $r(n,e){return c({[f]:"Union",anyOf:n},e)}function qs(n){return n.some(e=>An(e))}function lt(n){return n.map(e=>An(e)?Vs(e):e)}function Vs(n){return tn(n,[Rn])}function Hs(n,e){return qs(n)?kn($r(lt(n),e)):$r(lt(n),e)}function ue(n,e){return n.length===1?c(n[0],e):n.length===0?L(e):Hs(n,e)}function Y(n,e){return n.length===0?L(e):n.length===1?c(n[0],e):$r(n,e)}class mt extends Dn{}function Ws(n){return n.replace(/\\\$/g,"$").replace(/\\\*/g,"*").replace(/\\\^/g,"^").replace(/\\\|/g,"|").replace(/\\\(/g,"(").replace(/\\\)/g,")")}function zr(n,e,r){return n[e]===r&&n.charCodeAt(e-1)!==92}function wn(n,e){return zr(n,e,"(")}function ge(n,e){return zr(n,e,")")}function Dt(n,e){return zr(n,e,"|")}function Js(n){if(!(wn(n,0)&&ge(n,n.length-1)))return!1;let e=0;for(let r=0;r<n.length;r++)if(wn(n,r)&&(e+=1),ge(n,r)&&(e-=1),e===0&&r!==n.length-1)return!1;return!0}function Gs(n){return n.slice(1,n.length-1)}function Ys(n){let e=0;for(let r=0;r<n.length;r++)if(wn(n,r)&&(e+=1),ge(n,r)&&(e-=1),Dt(n,r)&&e===0)return!0;return!1}function Xs(n){for(let e=0;e<n.length;e++)if(wn(n,e))return!0;return!1}function Qs(n){let[e,r]=[0,0];const t=[];for(let a=0;a<n.length;a++)if(wn(n,a)&&(e+=1),ge(n,a)&&(e-=1),Dt(n,a)&&e===0){const u=n.slice(r,a);u.length>0&&t.push(ee(u)),r=a+1}const i=n.slice(r);return i.length>0&&t.push(ee(i)),t.length===0?{type:"const",const:""}:t.length===1?t[0]:{type:"or",expr:t}}function Zs(n){function e(i,a){if(!wn(i,a))throw new mt("TemplateLiteralParser: Index must point to open parens");let u=0;for(let d=a;d<i.length;d++)if(wn(i,d)&&(u+=1),ge(i,d)&&(u-=1),u===0)return[a,d];throw new mt("TemplateLiteralParser: Unclosed group parens in expression")}function r(i,a){for(let u=a;u<i.length;u++)if(wn(i,u))return[a,u];return[a,i.length]}const t=[];for(let i=0;i<n.length;i++)if(wn(n,i)){const[a,u]=e(n,i),d=n.slice(a,u+1);t.push(ee(d)),i=u}else{const[a,u]=r(n,i),d=n.slice(a,u);d.length>0&&t.push(ee(d)),i=u-1}return t.length===0?{type:"const",const:""}:t.length===1?t[0]:{type:"and",expr:t}}function ee(n){return Js(n)?ee(Gs(n)):Ys(n)?Qs(n):Xs(n)?Zs(n):{type:"const",const:Ws(n)}}function _r(n){return ee(n.slice(1,n.length-1))}class vs extends Dn{}function ni(n){return n.type==="or"&&n.expr.length===2&&n.expr[0].type==="const"&&n.expr[0].const==="0"&&n.expr[1].type==="const"&&n.expr[1].const==="[1-9][0-9]*"}function ei(n){return n.type==="or"&&n.expr.length===2&&n.expr[0].type==="const"&&n.expr[0].const==="true"&&n.expr[1].type==="const"&&n.expr[1].const==="false"}function ri(n){return n.type==="const"&&n.const===".*"}function je(n){return ni(n)||ri(n)?!1:ei(n)?!0:n.type==="and"?n.expr.every(e=>je(e)):n.type==="or"?n.expr.every(e=>je(e)):n.type==="const"?!0:(()=>{throw new vs("Unknown expression type")})()}function ti(n){const e=_r(n.pattern);return je(e)}class oi extends Dn{}function*zt(n){if(n.length===1)return yield*n[0];for(const e of n[0])for(const r of zt(n.slice(1)))yield`${e}${r}`}function*si(n){return yield*zt(n.expr.map(e=>[...cr(e)]))}function*ii(n){for(const e of n.expr)yield*cr(e)}function*ci(n){return yield n.const}function*cr(n){return n.type==="and"?yield*si(n):n.type==="or"?yield*ii(n):n.type==="const"?yield*ci(n):(()=>{throw new oi("Unknown expression")})()}function _t(n){const e=_r(n.pattern);return je(e)?[...cr(e)]:[]}function k(n,e){return c({[f]:"Literal",const:n,type:typeof n},e)}function qt(n){return c({[f]:"Boolean",type:"boolean"},n)}function qr(n){return c({[f]:"BigInt",type:"bigint"},n)}function Gn(n){return c({[f]:"Number",type:"number"},n)}function Bn(n){return c({[f]:"String",type:"string"},n)}function*ui(n){const e=n.trim().replace(/"|'/g,"");return e==="boolean"?yield qt():e==="number"?yield Gn():e==="bigint"?yield qr():e==="string"?yield Bn():yield(()=>{const r=e.split("|").map(t=>k(t.trim()));return r.length===0?L():r.length===1?r[0]:ue(r)})()}function*ai(n){if(n[1]!=="{"){const e=k("$"),r=gr(n.slice(1));return yield*[e,...r]}for(let e=2;e<n.length;e++)if(n[e]==="}"){const r=ui(n.slice(2,e)),t=gr(n.slice(e+1));return yield*[...r,...t]}yield k(n)}function*gr(n){for(let e=0;e<n.length;e++)if(n[e]==="$"){const r=k(n.slice(0,e)),t=ai(n.slice(e));return yield*[r,...t]}yield k(n)}function fi(n){return[...gr(n)]}class di extends Dn{}function li(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Vt(n,e){return qn(n)?n.pattern.slice(1,n.pattern.length-1):V(n)?`(${n.anyOf.map(r=>Vt(r,e)).join("|")})`:ce(n)?`${e}${ze}`:ie(n)?`${e}${ze}`:Xe(n)?`${e}${ze}`:Ae(n)?`${e}${Bt}`:zn(n)?`${e}${li(n.const.toString())}`:Te(n)?`${e}${Es}`:(()=>{throw new di(`Unexpected Kind '${n[f]}'`)})()}function pt(n){return`^${n.map(e=>Vt(e,"")).join("")}$`}function We(n){const r=_t(n).map(t=>k(t));return ue(r)}function Ht(n,e){const r=C(n)?pt(fi(n)):pt(n);return c({[f]:"TemplateLiteral",type:"string",pattern:r},e)}function mi(n){return _t(n).map(r=>r.toString())}function pi(n){const e=[];for(const r of n)e.push(...Cn(r));return e}function xi(n){return[n.toString()]}function Cn(n){return[...new Set(qn(n)?mi(n):V(n)?pi(n.anyOf):zn(n)?xi(n.const):ce(n)?["[number]"]:ie(n)?["[number]"]:[])]}function bi(n,e,r){const t={};for(const i of Object.getOwnPropertyNames(e))t[i]=ur(n,Cn(e[i]),r);return t}function Fi(n,e,r){return bi(n,e.properties,r)}function Ii(n,e,r){const t=Fi(n,e,r);return G(t)}function Wt(n,e){return n.map(r=>Jt(r,e))}function yi(n){return n.filter(e=>!Pe(e))}function Oi(n,e){return Qt(yi(Wt(n,e)))}function $i(n){return n.some(e=>Pe(e))?[]:n}function gi(n,e){return ue($i(Wt(n,e)))}function ji(n,e){return e in n?n[e]:e==="[number]"?ue(n):L()}function wi(n,e){return e==="[number]"?n:L()}function hi(n,e){return e in n?n[e]:L()}function Jt(n,e){return ln(n)?Oi(n.allOf,e):V(n)?gi(n.anyOf,e):Vn(n)?ji(n.items??[],e):re(n)?wi(n.items,e):yn(n)?hi(n.properties,e):L()}function Gt(n,e){return e.map(r=>Jt(n,r))}function xt(n,e){return ue(Gt(n,e))}function ur(n,e,r){if(Z(n)||Z(e)){const t="Index types using Ref parameters require both Type and Key to be of TSchema";if(!Pn(n)||!Pn(e))throw new Dn(t);return z("Index",[n,e])}return sn(e)?Ii(n,e,r):_n(e)?Pi(n,e,r):c(Pn(e)?xt(n,Cn(e)):xt(n,e),r)}function Ri(n,e,r){return{[e]:ur(n,[e],rn(r))}}function Ni(n,e,r){return e.reduce((t,i)=>({...t,...Ri(n,i,r)}),{})}function Ti(n,e,r){return Ni(n,e.keys,r)}function Pi(n,e,r){const t=Ti(n,e,r);return G(t)}function Vr(n,e){return c({[f]:"Iterator",type:"Iterator",items:n},e)}function Ai(n){const e=[];for(let r in n)An(n[r])||e.push(r);return e}function Si(n,e){const r=Ai(n),t=r.length>0?{[f]:"Object",type:"object",properties:n,required:r}:{[f]:"Object",type:"object",properties:n};return c(t,e)}var q=Si;function Yt(n,e){return c({[f]:"Promise",type:"Promise",item:n},e)}function Ei(n){return c(tn(n,[Ne]))}function Ci(n){return c({...n,[Ne]:"Readonly"})}function Ui(n,e){return e===!1?Ei(n):Ci(n)}function Un(n,e){const r=e??!0;return sn(n)?Li(n,r):Ui(n,r)}function ki(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=Un(n[t],e);return r}function Mi(n,e){return ki(n.properties,e)}function Li(n,e){const r=Mi(n,e);return G(r)}function ae(n,e){return c(n.length>0?{[f]:"Tuple",type:"array",items:n,additionalItems:!1,minItems:n.length,maxItems:n.length}:{[f]:"Tuple",type:"array",minItems:n.length,maxItems:n.length},e)}function Xt(n,e){return n in e?an(n,e[n]):G(e)}function Ki(n){return{[n]:k(n)}}function Bi(n){const e={};for(const r of n)e[r]=k(r);return e}function Di(n,e){return ks(e,n)?Ki(n):Bi(e)}function zi(n,e){const r=Di(n,e);return Xt(n,r)}function be(n,e){return e.map(r=>an(n,r))}function _i(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(e))r[t]=an(n,e[t]);return r}function an(n,e){const r={...e};return An(e)?kn(an(n,tn(e,[Rn]))):Tr(e)?Un(an(n,tn(e,[Ne]))):sn(e)?Xt(n,e.properties):_n(e)?zi(n,e.keys):oe(e)?Dr(be(n,e.parameters),an(n,e.returns),r):se(e)?Ee(be(n,e.parameters),an(n,e.returns),r):Ye(e)?Br(an(n,e.items),r):Qe(e)?Vr(an(n,e.items),r):ln(e)?Mn(be(n,e.allOf),r):V(e)?Y(be(n,e.anyOf),r):Vn(e)?ae(be(n,e.items??[]),r):yn(e)?q(_i(n,e.properties),r):re(e)?Kr(an(n,e.items),r):Ze(e)?Yt(an(n,e.item),r):e}function qi(n,e){const r={};for(const t of n)r[t]=an(t,e);return r}function Vi(n,e,r){const t=Pn(n)?Cn(n):n,i=e({[f]:"MappedKey",keys:t}),a=qi(t,i);return q(a,r)}function Hi(n){return c(tn(n,[Rn]))}function Wi(n){return c({...n,[Rn]:"Optional"})}function Ji(n,e){return e===!1?Hi(n):Wi(n)}function kn(n,e){const r=e??!0;return sn(n)?Xi(n,r):Ji(n,r)}function Gi(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=kn(n[t],e);return r}function Yi(n,e){return Gi(n.properties,e)}function Xi(n,e){const r=Yi(n,e);return G(r)}function jr(n,e={}){const r=n.every(i=>yn(i)),t=Pn(e.unevaluatedProperties)?{unevaluatedProperties:e.unevaluatedProperties}:{};return c(e.unevaluatedProperties===!1||Pn(e.unevaluatedProperties)||r?{...t,[f]:"Intersect",type:"object",allOf:n}:{...t,[f]:"Intersect",allOf:n},e)}function Qi(n){return n.every(e=>An(e))}function Zi(n){return tn(n,[Rn])}function bt(n){return n.map(e=>An(e)?Zi(e):e)}function vi(n,e){return Qi(n)?kn(jr(bt(n),e)):jr(bt(n),e)}function Qt(n,e={}){if(n.length===1)return c(n[0],e);if(n.length===0)return L(e);if(n.some(r=>nr(r)))throw new Error("Cannot intersect transform types");return vi(n,e)}function Mn(n,e){if(n.length===1)return c(n[0],e);if(n.length===0)return L(e);if(n.some(r=>nr(r)))throw new Error("Cannot intersect transform types");return jr(n,e)}function Ce(...n){const[e,r]=typeof n[0]=="string"?[n[0],n[1]]:[n[0].$id,n[1]];if(typeof e!="string")throw new Dn("Ref: $ref must be a string");return c({[f]:"Ref",$ref:e},r)}function nc(n,e){return z("Awaited",[z(n,e)])}function ec(n){return z("Awaited",[Ce(n)])}function rc(n){return Mn(Zt(n))}function tc(n){return Y(Zt(n))}function oc(n){return ar(n)}function Zt(n){return n.map(e=>ar(e))}function ar(n,e){return c(te(n)?nc(n.target,n.parameters):ln(n)?rc(n.allOf):V(n)?tc(n.anyOf):Ze(n)?oc(n.item):Z(n)?ec(n.$ref):n,e)}function vt(n){const e=[];for(const r of n)e.push(Hr(r));return e}function sc(n){const e=vt(n);return Ds(e)}function ic(n){const e=vt(n);return Bs(e)}function cc(n){return n.map((e,r)=>r.toString())}function uc(n){return["[number]"]}function ac(n){return globalThis.Object.getOwnPropertyNames(n)}function fc(n){return[]}function Hr(n){return ln(n)?sc(n.allOf):V(n)?ic(n.anyOf):Vn(n)?cc(n.items??[]):re(n)?uc(n.items):yn(n)?ac(n.properties):ve(n)?fc(n.patternProperties):[]}function dc(n,e){return z("KeyOf",[z(n,e)])}function lc(n){return z("KeyOf",[Ce(n)])}function mc(n,e){const r=Hr(n),t=pc(r),i=ue(t);return c(i,e)}function pc(n){return n.map(e=>e==="[number]"?Gn():k(e))}function Wr(n,e){return te(n)?dc(n.target,n.parameters):Z(n)?lc(n.$ref):sn(n)?Fc(n,e):mc(n,e)}function xc(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=Wr(n[t],rn(e));return r}function bc(n,e){return xc(n.properties,e)}function Fc(n,e){const r=bc(n,e);return G(r)}function Ic(n){const e=[];for(const r of n)e.push(...Hr(r));return Ms(e)}function yc(n){return n.filter(e=>!Pe(e))}function Oc(n,e){const r=[];for(const t of n)r.push(...Gt(t,[e]));return yc(r)}function $c(n,e){const r={};for(const t of e)r[t]=Qt(Oc(n,t));return r}function gc(n,e){const r=Ic(n),t=$c(n,r);return q(t,e)}function no(n){return c({[f]:"Date",type:"Date"},n)}function eo(n){return c({[f]:"Null",type:"null"},n)}function ro(n){return c({[f]:"Symbol",type:"symbol"},n)}function to(n){return c({[f]:"Undefined",type:"undefined"},n)}function oo(n){return c({[f]:"Uint8Array",type:"Uint8Array"},n)}function fr(n){return c({[f]:"Unknown"},n)}function jc(n){return n.map(e=>Jr(e,!1))}function wc(n){const e={};for(const r of globalThis.Object.getOwnPropertyNames(n))e[r]=Un(Jr(n[r],!1));return e}function Ke(n,e){return e===!0?n:Un(n)}function Jr(n,e){return Yo(n)||Qo(n)?Ke($e(),e):nn(n)?Un(ae(jc(n))):Re(n)?oo():Rr(n)?no():M(n)?Ke(q(wc(n)),e):Xo(n)?Ke(Ee([],fr()),e):U(n)?to():Zo(n)?eo():vo(n)?ro():Rt(n)?qr():On(n)||he(n)||C(n)?k(n):q({})}function hc(n,e){return c(Jr(n,!0),e)}function Rc(n,e){return oe(n)?ae(n.parameters,e):L(e)}function Nc(n,e){if(U(n))throw new Error("Enum undefined or empty");const r=globalThis.Object.getOwnPropertyNames(n).filter(a=>isNaN(a)).map(a=>n[a]),i=[...new Set(r)].map(a=>k(a));return Y(i,{...e,[Ge]:"Enum"})}class Tc extends Dn{}var s;(function(n){n[n.Union=0]="Union",n[n.True=1]="True",n[n.False=2]="False"})(s||(s={}));function dn(n){return n===s.False?n:s.True}function fe(n){throw new Tc(n)}function K(n){return En(n)||Jn(n)||hn(n)||Fn(n)||xn(n)}function B(n,e){return En(e)?co():Jn(e)?dr(n,e):hn(e)?Yr(n,e):Fn(e)?lo():xn(e)?Gr():fe("StructuralRight")}function Gr(n,e){return s.True}function Pc(n,e){return Jn(e)?dr(n,e):hn(e)&&e.anyOf.some(r=>xn(r)||Fn(r))?s.True:hn(e)?s.Union:Fn(e)||xn(e)?s.True:s.Union}function Ac(n,e){return Fn(n)?s.False:xn(n)?s.Union:En(n)?s.True:s.False}function Sc(n,e){return P(e)&&lr(e)?s.True:K(e)?B(n,e):Hn(e)?dn(g(n.items,e.items)):s.False}function Ec(n,e){return K(e)?B(n,e):Ur(e)?dn(g(n.items,e.items)):s.False}function Cc(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):er(e)?s.True:s.False}function so(n,e){return Kt(n)||Wn(n)?s.True:s.False}function Uc(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):Wn(e)?s.True:s.False}function kc(n,e){return K(e)?B(n,e):P(e)?X(n,e):rr(e)?n.parameters.length>e.parameters.length?s.False:n.parameters.every((r,t)=>dn(g(e.parameters[t],r))===s.True)?dn(g(n.returns,e.returns)):s.False:s.False}function Mc(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):tr(e)?s.True:s.False}function Lc(n,e){return K(e)?B(n,e):P(e)?X(n,e):or(e)?n.parameters.length>e.parameters.length?s.False:n.parameters.every((r,t)=>dn(g(e.parameters[t],r))===s.True)?dn(g(n.returns,e.returns)):s.False:s.False}function io(n,e){return Sn(n)&&On(n.const)||Q(n)||Nn(n)?s.True:s.False}function Kc(n,e){return Nn(e)||Q(e)?s.True:K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):s.False}function dr(n,e){return e.allOf.every(r=>g(n,r)===s.True)?s.True:s.False}function Bc(n,e){return n.allOf.some(r=>g(r,e)===s.True)?s.True:s.False}function Dc(n,e){return K(e)?B(n,e):kr(e)?dn(g(n.items,e.items)):s.False}function zc(n,e){return Sn(e)&&e.const===n.const?s.True:K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):bn(e)?fo(n):Q(e)?uo(n):Nn(e)?io(n):Wn(e)?so(n):s.False}function co(n,e){return s.False}function _c(n,e){return s.True}function Ft(n){let[e,r]=[n,0];for(;Zn(e);)e=e.not,r+=1;return r%2===0?e:fr()}function qc(n,e){return Zn(n)?g(Ft(n),e):Zn(e)?g(n,Ft(e)):fe("Invalid fallthrough for Not")}function Vc(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):Mr(e)?s.True:s.False}function uo(n,e){return Lt(n)||Q(n)||Nn(n)?s.True:s.False}function Hc(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):Nn(e)||Q(e)?s.True:s.False}function v(n,e){return Object.getOwnPropertyNames(n.properties).length===e}function It(n){return lr(n)}function yt(n){return v(n,0)||v(n,1)&&"description"in n.properties&&hn(n.properties.description)&&n.properties.description.anyOf.length===2&&(bn(n.properties.description.anyOf[0])&&Kn(n.properties.description.anyOf[1])||bn(n.properties.description.anyOf[1])&&Kn(n.properties.description.anyOf[0]))}function br(n){return v(n,0)}function Ot(n){return v(n,0)}function Wc(n){return v(n,0)}function Jc(n){return v(n,0)}function Gc(n){return lr(n)}function Yc(n){const e=Gn();return v(n,0)||v(n,1)&&"length"in n.properties&&dn(g(n.properties.length,e))===s.True}function Xc(n){return v(n,0)}function lr(n){const e=Gn();return v(n,0)||v(n,1)&&"length"in n.properties&&dn(g(n.properties.length,e))===s.True}function Qc(n){const e=Ee([$e()],$e());return v(n,0)||v(n,1)&&"then"in n.properties&&dn(g(n.properties.then,e))===s.True}function ao(n,e){return g(n,e)===s.False||He(n)&&!He(e)?s.False:s.True}function X(n,e){return Fn(n)?s.False:xn(n)?s.Union:En(n)||Mt(n)&&It(e)||Lt(n)&&br(e)||Kt(n)&&Ot(e)||ye(n)&&yt(e)||er(n)&&Wc(e)||bn(n)&&It(e)||ye(n)&&yt(e)||Q(n)&&br(e)||Nn(n)&&br(e)||Wn(n)&&Ot(e)||Se(n)&&Gc(e)||tr(n)&&Jc(e)||rr(n)&&Xc(e)||or(n)&&Yc(e)?s.True:W(n)&&bn(wr(n))?e[Ge]==="Record"?s.True:s.False:W(n)&&Q(wr(n))?v(e,0)?s.True:s.False:s.False}function Zc(n,e){return K(e)?B(n,e):W(e)?mn(n,e):P(e)?(()=>{for(const r of Object.getOwnPropertyNames(e.properties)){if(!(r in n.properties)&&!He(e.properties[r]))return s.False;if(He(e.properties[r]))return s.True;if(ao(n.properties[r],e.properties[r])===s.False)return s.False}return s.True})():s.False}function vc(n,e){return K(e)?B(n,e):P(e)&&Qc(e)?s.True:Lr(e)?dn(g(n.item,e.item)):s.False}function wr(n){return vn in n.patternProperties?Gn():ne in n.patternProperties?Bn():fe("Unknown record key pattern")}function hr(n){return vn in n.patternProperties?n.patternProperties[vn]:ne in n.patternProperties?n.patternProperties[ne]:fe("Unable to get record value schema")}function mn(n,e){const[r,t]=[wr(e),hr(e)];return Mt(n)&&Q(r)&&dn(g(n,t))===s.True?s.True:Se(n)&&Q(r)||bn(n)&&Q(r)||Hn(n)&&Q(r)?g(n,t):P(n)?(()=>{for(const i of Object.getOwnPropertyNames(n.properties))if(ao(t,n.properties[i])===s.False)return s.False;return s.True})():s.False}function nu(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?g(hr(n),hr(e)):s.False}function eu(n,e){const r=Ie(n)?Bn():n,t=Ie(e)?Bn():e;return g(r,t)}function fo(n,e){return Sn(n)&&C(n.const)||bn(n)?s.True:s.False}function ru(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):bn(e)?s.True:s.False}function tu(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):ye(e)?s.True:s.False}function ou(n,e){return Oe(n)?g(We(n),e):Oe(e)?g(n,We(e)):fe("Invalid fallthrough for TemplateLiteral")}function su(n,e){return Hn(e)&&n.items!==void 0&&n.items.every(r=>g(r,e.items)===s.True)}function iu(n,e){return En(n)?s.True:Fn(n)?s.False:xn(n)?s.Union:s.False}function cu(n,e){return K(e)?B(n,e):P(e)&&lr(e)||Hn(e)&&su(n,e)?s.True:sr(e)?U(n.items)&&!U(e.items)||!U(n.items)&&U(e.items)?s.False:U(n.items)&&!U(e.items)||n.items.every((r,t)=>g(r,e.items[t])===s.True)?s.True:s.False:s.False}function uu(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):Se(e)?s.True:s.False}function au(n,e){return K(e)?B(n,e):P(e)?X(n,e):W(e)?mn(n,e):ir(e)?lu(n):Kn(e)?s.True:s.False}function Yr(n,e){return e.anyOf.some(r=>g(n,r)===s.True)?s.True:s.False}function fu(n,e){return n.anyOf.every(r=>g(r,e)===s.True)?s.True:s.False}function lo(n,e){return s.True}function du(n,e){return En(e)?co():Jn(e)?dr(n,e):hn(e)?Yr(n,e):xn(e)?Gr():bn(e)?fo(n):Q(e)?uo(n):Nn(e)?io(n):Wn(e)?so(n):Hn(e)?Ac(n):sr(e)?iu(n):P(e)?X(n,e):Fn(e)?s.True:s.False}function lu(n,e){return Kn(n)||Kn(n)?s.True:s.False}function mu(n,e){return Jn(e)?dr(n,e):hn(e)?Yr(n,e):Fn(e)?lo():xn(e)?Gr():P(e)?X(n,e):ir(e)?s.True:s.False}function g(n,e){return Oe(n)||Oe(e)?ou(n,e):Ie(n)||Ie(e)?eu(n,e):Zn(n)||Zn(e)?qc(n,e):xn(n)?Pc(n,e):Hn(n)?Sc(n,e):er(n)?Cc(n,e):Wn(n)?Uc(n,e):Ur(n)?Ec(n,e):rr(n)?kc(n,e):tr(n)?Mc(n,e):or(n)?Lc(n,e):Nn(n)?Kc(n,e):Jn(n)?Bc(n,e):kr(n)?Dc(n,e):Sn(n)?zc(n,e):En(n)?_c():Mr(n)?Vc(n,e):Q(n)?Hc(n,e):P(n)?Zc(n,e):W(n)?nu(n,e):bn(n)?ru(n,e):ye(n)?tu(n,e):sr(n)?cu(n,e):Lr(n)?vc(n,e):Se(n)?uu(n,e):Kn(n)?au(n,e):hn(n)?fu(n,e):Fn(n)?du(n,e):ir(n)?mu(n,e):fe(`Unknown left type operand '${n[f]}'`)}function Ue(n,e){return g(n,e)}function pu(n,e,r,t,i){const a={};for(const u of globalThis.Object.getOwnPropertyNames(n))a[u]=Xr(n[u],e,r,t,rn(i));return a}function xu(n,e,r,t,i){return pu(n.properties,e,r,t,i)}function bu(n,e,r,t,i){const a=xu(n,e,r,t,i);return G(a)}function Fu(n,e,r,t){const i=Ue(n,e);return i===s.Union?Y([r,t]):i===s.True?r:t}function Xr(n,e,r,t,i){return sn(n)?bu(n,e,r,t,i):_n(n)?c($u(n,e,r,t,i)):c(Fu(n,e,r,t),i)}function Iu(n,e,r,t,i){return{[n]:Xr(k(n),e,r,t,rn(i))}}function yu(n,e,r,t,i){return n.reduce((a,u)=>({...a,...Iu(u,e,r,t,i)}),{})}function Ou(n,e,r,t,i){return yu(n.keys,e,r,t,i)}function $u(n,e,r,t,i){const a=Ou(n,e,r,t,i);return G(a)}function gu(n,e){return Qr(We(n),e)}function ju(n,e){const r=n.filter(t=>Ue(t,e)===s.False);return r.length===1?r[0]:Y(r)}function Qr(n,e,r={}){return qn(n)?c(gu(n,e),r):sn(n)?c(Ru(n,e),r):c(V(n)?ju(n.anyOf,e):Ue(n,e)!==s.False?L():n,r)}function wu(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=Qr(n[t],e);return r}function hu(n,e){return wu(n.properties,e)}function Ru(n,e){const r=hu(n,e);return G(r)}function Nu(n,e){return Zr(We(n),e)}function Tu(n,e){const r=n.filter(t=>Ue(t,e)!==s.False);return r.length===1?r[0]:Y(r)}function Zr(n,e,r){return qn(n)?c(Nu(n,e),r):sn(n)?c(Su(n,e),r):c(V(n)?Tu(n.anyOf,e):Ue(n,e)!==s.False?n:L(),r)}function Pu(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=Zr(n[t],e);return r}function Au(n,e){return Pu(n.properties,e)}function Su(n,e){const r=Au(n,e);return G(r)}function Eu(n,e){return oe(n)?c(n.returns,e):L(e)}function mo(n){return Un(kn(n))}function Yn(n,e,r){return c({[f]:"Record",type:"object",patternProperties:{[n]:e}},r)}function vr(n,e,r){const t={};for(const i of n)t[i]=e;return q(t,{...r,[Ge]:"Record"})}function Cu(n,e,r){return ti(n)?vr(Cn(n),e,r):Yn(n.pattern,e,r)}function Uu(n,e,r){return vr(Cn(Y(n)),e,r)}function ku(n,e,r){return vr([n.toString()],e,r)}function Mu(n,e,r){return Yn(n.source,e,r)}function Lu(n,e,r){const t=U(n.pattern)?ne:n.pattern;return Yn(t,e,r)}function Ku(n,e,r){return Yn(ne,e,r)}function Bu(n,e,r){return Yn(Us,e,r)}function Du(n,e,r){return q({true:e,false:e},r)}function zu(n,e,r){return Yn(vn,e,r)}function _u(n,e,r){return Yn(vn,e,r)}function po(n,e,r={}){return V(n)?Uu(n.anyOf,e,r):qn(n)?Cu(n,e,r):zn(n)?ku(n.const,e,r):Te(n)?Du(n,e,r):ie(n)?zu(n,e,r):ce(n)?_u(n,e,r):St(n)?Mu(n,e,r):Ae(n)?Lu(n,e,r):Tt(n)?Ku(n,e,r):Pe(n)?Bu(n,e,r):L(r)}function nt(n){return globalThis.Object.getOwnPropertyNames(n.patternProperties)[0]}function qu(n){const e=nt(n);return e===ne?Bn():e===vn?Gn():Bn({pattern:e})}function xo(n){return n.patternProperties[nt(n)]}function Vu(n,e){return e.parameters=ke(n,e.parameters),e.returns=In(n,e.returns),e}function Hu(n,e){return e.parameters=ke(n,e.parameters),e.returns=In(n,e.returns),e}function Wu(n,e){return e.allOf=ke(n,e.allOf),e}function Ju(n,e){return e.anyOf=ke(n,e.anyOf),e}function Gu(n,e){return U(e.items)||(e.items=ke(n,e.items)),e}function Yu(n,e){return e.items=In(n,e.items),e}function Xu(n,e){return e.items=In(n,e.items),e}function Qu(n,e){return e.items=In(n,e.items),e}function Zu(n,e){return e.item=In(n,e.item),e}function vu(n,e){const r=ta(n,e.properties);return{...e,...q(r)}}function na(n,e){const r=In(n,qu(e)),t=In(n,xo(e)),i=po(r,t);return{...e,...i}}function ea(n,e){return e.index in n?n[e.index]:fr()}function ra(n,e){const r=Tr(e),t=An(e),i=In(n,e);return r&&t?mo(i):r&&!t?Un(i):!r&&t?kn(i):i}function ta(n,e){return globalThis.Object.getOwnPropertyNames(e).reduce((r,t)=>({...r,[t]:ra(n,e[t])}),{})}function ke(n,e){return e.map(r=>In(n,r))}function In(n,e){return oe(e)?Vu(n,e):se(e)?Hu(n,e):ln(e)?Wu(n,e):V(e)?Ju(n,e):Vn(e)?Gu(n,e):re(e)?Yu(n,e):Ye(e)?Xu(n,e):Qe(e)?Qu(n,e):Ze(e)?Zu(n,e):yn(e)?vu(n,e):ve(e)?na(n,e):Pt(e)?ea(n,e):e}function oa(n,e){return In(e,Nr(n))}function sa(n){return c({[f]:"Integer",type:"integer"},n)}function ia(n,e,r){return{[n]:de(k(n),e,rn(r))}}function ca(n,e,r){return n.reduce((i,a)=>({...i,...ia(a,e,r)}),{})}function ua(n,e,r){return ca(n.keys,e,r)}function aa(n,e,r){const t=ua(n,e,r);return G(t)}function fa(n){const[e,r]=[n.slice(0,1),n.slice(1)];return[e.toLowerCase(),r].join("")}function da(n){const[e,r]=[n.slice(0,1),n.slice(1)];return[e.toUpperCase(),r].join("")}function la(n){return n.toUpperCase()}function ma(n){return n.toLowerCase()}function pa(n,e,r){const t=_r(n.pattern);if(!je(t))return{...n,pattern:bo(n.pattern,e)};const u=[...cr(t)].map(h=>k(h)),d=Fo(u,e),$=Y(d);return Ht([$],r)}function bo(n,e){return typeof n=="string"?e==="Uncapitalize"?fa(n):e==="Capitalize"?da(n):e==="Uppercase"?la(n):e==="Lowercase"?ma(n):n:n.toString()}function Fo(n,e){return n.map(r=>de(r,e))}function de(n,e,r={}){return _n(n)?aa(n,e,r):qn(n)?pa(n,e,r):V(n)?Y(Fo(n.anyOf,e),r):zn(n)?k(bo(n.const,e),r):c(n,r)}function xa(n,e={}){return de(n,"Capitalize",e)}function ba(n,e={}){return de(n,"Lowercase",e)}function Fa(n,e={}){return de(n,"Uncapitalize",e)}function Ia(n,e={}){return de(n,"Uppercase",e)}function ya(n,e,r){const t={};for(const i of globalThis.Object.getOwnPropertyNames(n))t[i]=mr(n[i],e,rn(r));return t}function Oa(n,e,r){return ya(n.properties,e,r)}function $a(n,e,r){const t=Oa(n,e,r);return G(t)}function ga(n,e){return n.map(r=>et(r,e))}function ja(n,e){return n.map(r=>et(r,e))}function wa(n,e){const{[e]:r,...t}=n;return t}function ha(n,e){return e.reduce((r,t)=>wa(r,t),n)}function Ra(n,e){const r=tn(n,[fn,"$id","required","properties"]),t=ha(n.properties,e);return q(t,r)}function Na(n){const e=n.reduce((r,t)=>At(t)?[...r,k(t)]:r,[]);return Y(e)}function et(n,e){return ln(n)?Mn(ga(n.allOf,e)):V(n)?Y(ja(n.anyOf,e)):yn(n)?Ra(n,e):q({})}function mr(n,e,r){const t=nn(e)?Na(e):e,i=Pn(e)?Cn(e):e,a=Z(n),u=Z(e);return sn(n)?$a(n,i,r):_n(e)?Sa(n,e,r):a&&u?z("Omit",[n,t],r):!a&&u?z("Omit",[n,t],r):a&&!u?z("Omit",[n,t],r):c({...et(n,i),...r})}function Ta(n,e,r){return{[e]:mr(n,[e],rn(r))}}function Pa(n,e,r){return e.reduce((t,i)=>({...t,...Ta(n,i,r)}),{})}function Aa(n,e,r){return Pa(n,e.keys,r)}function Sa(n,e,r){const t=Aa(n,e,r);return G(t)}function Ea(n,e,r){const t={};for(const i of globalThis.Object.getOwnPropertyNames(n))t[i]=pr(n[i],e,rn(r));return t}function Ca(n,e,r){return Ea(n.properties,e,r)}function Ua(n,e,r){const t=Ca(n,e,r);return G(t)}function ka(n,e){return n.map(r=>rt(r,e))}function Ma(n,e){return n.map(r=>rt(r,e))}function La(n,e){const r={};for(const t of e)t in n&&(r[t]=n[t]);return r}function Ka(n,e){const r=tn(n,[fn,"$id","required","properties"]),t=La(n.properties,e);return q(t,r)}function Ba(n){const e=n.reduce((r,t)=>At(t)?[...r,k(t)]:r,[]);return Y(e)}function rt(n,e){return ln(n)?Mn(ka(n.allOf,e)):V(n)?Y(Ma(n.anyOf,e)):yn(n)?Ka(n,e):q({})}function pr(n,e,r){const t=nn(e)?Ba(e):e,i=Pn(e)?Cn(e):e,a=Z(n),u=Z(e);return sn(n)?Ua(n,i,r):_n(e)?qa(n,e,r):a&&u?z("Pick",[n,t],r):!a&&u?z("Pick",[n,t],r):a&&!u?z("Pick",[n,t],r):c({...rt(n,i),...r})}function Da(n,e,r){return{[e]:pr(n,[e],rn(r))}}function za(n,e,r){return e.reduce((t,i)=>({...t,...Da(n,i,r)}),{})}function _a(n,e,r){return za(n,e.keys,r)}function qa(n,e,r){const t=_a(n,e,r);return G(t)}function Va(n,e){return z("Partial",[z(n,e)])}function Ha(n){return z("Partial",[Ce(n)])}function Wa(n){const e={};for(const r of globalThis.Object.getOwnPropertyNames(n))e[r]=kn(n[r]);return e}function Ja(n){const e=tn(n,[fn,"$id","required","properties"]),r=Wa(n.properties);return q(r,e)}function $t(n){return n.map(e=>Io(e))}function Io(n){return te(n)?Va(n.target,n.parameters):Z(n)?Ha(n.$ref):ln(n)?Mn($t(n.allOf)):V(n)?Y($t(n.anyOf)):yn(n)?Ja(n):Xe(n)||Te(n)||ie(n)||zn(n)||Pr(n)||ce(n)||Ae(n)||Ar(n)||Sr(n)?n:q({})}function tt(n,e){return sn(n)?Xa(n,e):c({...Io(n),...e})}function Ga(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=tt(n[t],rn(e));return r}function Ya(n,e){return Ga(n.properties,e)}function Xa(n,e){const r=Ya(n,e);return G(r)}function Qa(n,e){return z("Required",[z(n,e)])}function Za(n){return z("Required",[Ce(n)])}function va(n){const e={};for(const r of globalThis.Object.getOwnPropertyNames(n))e[r]=tn(n[r],[Rn]);return e}function nf(n){const e=tn(n,[fn,"$id","required","properties"]),r=va(n.properties);return q(r,e)}function gt(n){return n.map(e=>yo(e))}function yo(n){return te(n)?Qa(n.target,n.parameters):Z(n)?Za(n.$ref):ln(n)?Mn(gt(n.allOf)):V(n)?Y(gt(n.anyOf)):yn(n)?nf(n):Xe(n)||Te(n)||ie(n)||zn(n)||Pr(n)||ce(n)||Ae(n)||Ar(n)||Sr(n)?n:q({})}function ot(n,e){return sn(n)?tf(n,e):c({...yo(n),...e})}function ef(n,e){const r={};for(const t of globalThis.Object.getOwnPropertyNames(n))r[t]=ot(n[t],e);return r}function rf(n,e){return ef(n.properties,e)}function tf(n,e){const r=rf(n,e);return G(r)}function of(n,e){return e.map(r=>Z(r)?st(n,r.$ref):on(n,r))}function st(n,e){return e in n?Z(n[e])?st(n,n[e].$ref):on(n,n[e]):L()}function sf(n){return ar(n[0])}function cf(n){return ur(n[0],n[1])}function uf(n){return Wr(n[0])}function af(n){return tt(n[0])}function ff(n){return mr(n[0],n[1])}function df(n){return pr(n[0],n[1])}function lf(n){return ot(n[0])}function mf(n,e,r){const t=of(n,r);return e==="Awaited"?sf(t):e==="Index"?cf(t):e==="KeyOf"?uf(t):e==="Partial"?af(t):e==="Omit"?ff(t):e==="Pick"?df(t):e==="Required"?lf(t):L()}function pf(n,e){return Kr(on(n,e))}function xf(n,e){return Br(on(n,e))}function bf(n,e,r){return Dr(Me(n,e),on(n,r))}function Ff(n,e,r){return Ee(Me(n,e),on(n,r))}function If(n,e){return Mn(Me(n,e))}function yf(n,e){return Vr(on(n,e))}function Of(n,e){return q(globalThis.Object.keys(e).reduce((r,t)=>({...r,[t]:on(n,e[t])}),{}))}function $f(n,e){const[r,t]=[on(n,xo(e)),nt(e)],i=Nr(e);return i.patternProperties[t]=r,i}function gf(n,e){return Z(e)?{...st(n,e.$ref),[fn]:e[fn]}:e}function jf(n,e){return ae(Me(n,e))}function wf(n,e){return Y(Me(n,e))}function Me(n,e){return e.map(r=>on(n,r))}function on(n,e){return An(e)?c(on(n,tn(e,[Rn])),e):Tr(e)?c(on(n,tn(e,[Ne])),e):nr(e)?c(gf(n,e),e):re(e)?c(pf(n,e.items),e):Ye(e)?c(xf(n,e.items),e):te(e)?c(mf(n,e.target,e.parameters)):oe(e)?c(bf(n,e.parameters,e.returns),e):se(e)?c(Ff(n,e.parameters,e.returns),e):ln(e)?c(If(n,e.allOf),e):Qe(e)?c(yf(n,e.items),e):yn(e)?c(Of(n,e.properties),e):ve(e)?c($f(n,e)):Vn(e)?c(jf(n,e.items||[]),e):V(e)?c(wf(n,e.anyOf),e):e}function hf(n,e){return e in n?on(n,n[e]):L()}function Rf(n){return globalThis.Object.getOwnPropertyNames(n).reduce((e,r)=>({...e,[r]:hf(n,r)}),{})}class Nf{constructor(e){const r=Rf(e),t=this.WithIdentifiers(r);this.$defs=t}Import(e,r){const t={...this.$defs,[e]:c(this.$defs[e],r)};return c({[f]:"Import",$defs:t,$ref:e})}WithIdentifiers(e){return globalThis.Object.getOwnPropertyNames(e).reduce((r,t)=>({...r,[t]:{...e[t],$id:t}}),{})}}function Tf(n){return new Nf(n)}function Pf(n,e){return c({[f]:"Not",not:n},e)}function Af(n,e){return se(n)?ae(n.parameters,e):L()}let Sf=0;function Ef(n,e={}){U(e.$id)&&(e.$id=`T${Sf++}`);const r=Nr(n({[f]:"This",$ref:`${e.$id}`}));return r.$id=e.$id,c({[Ge]:"Recursive",...r},e)}function Cf(n,e){const r=C(n)?new globalThis.RegExp(n):n;return c({[f]:"RegExp",type:"RegExp",source:r.source,flags:r.flags},e)}function Uf(n){return ln(n)?n.allOf:V(n)?n.anyOf:Vn(n)?n.items??[]:[]}function kf(n){return Uf(n)}function Mf(n,e){return se(n)?c(n.returns,e):L(e)}class Lf{constructor(e){this.schema=e}Decode(e){return new Kf(this.schema,e)}}class Kf{constructor(e,r){this.schema=e,this.decode=r}EncodeTransform(e,r){const a={Encode:u=>r[fn].Encode(e(u)),Decode:u=>this.decode(r[fn].Decode(u))};return{...r,[fn]:a}}EncodeSchema(e,r){const t={Decode:this.decode,Encode:e};return{...r,[fn]:t}}Encode(e){return nr(this.schema)?this.EncodeTransform(e,this.schema):this.EncodeSchema(e,this.schema)}}function Bf(n){return new Lf(n)}function Df(n={}){return c({[f]:n[f]??"Unsafe"},n)}function zf(n){return c({[f]:"Void",type:"void"},n)}const _f=Object.freeze(Object.defineProperty({__proto__:null,Any:$e,Argument:zs,Array:Kr,AsyncIterator:Br,Awaited:ar,BigInt:qr,Boolean:qt,Capitalize:xa,Composite:gc,Const:hc,Constructor:Dr,ConstructorParameters:Rc,Date:no,Enum:Nc,Exclude:Qr,Extends:Xr,Extract:Zr,Function:Ee,Index:ur,InstanceType:Eu,Instantiate:oa,Integer:sa,Intersect:Mn,Iterator:Vr,KeyOf:Wr,Literal:k,Lowercase:ba,Mapped:Vi,Module:Tf,Never:L,Not:Pf,Null:eo,Number:Gn,Object:q,Omit:mr,Optional:kn,Parameters:Af,Partial:tt,Pick:pr,Promise:Yt,Readonly:Un,ReadonlyOptional:mo,Record:po,Recursive:Ef,Ref:Ce,RegExp:Cf,Required:ot,Rest:kf,ReturnType:Mf,String:Bn,Symbol:ro,TemplateLiteral:Ht,Transform:Bf,Tuple:ae,Uint8Array:oo,Uncapitalize:Fa,Undefined:to,Union:Y,Unknown:fr,Unsafe:Df,Uppercase:Ia,Void:zf},Symbol.toStringTag,{value:"Module"})),un=_f,qf=un.Object({status:un.Union([un.Literal("ok"),un.Literal("failed")],{description:"状态 (ok/failed)"}),retcode:un.Number({description:"返回码"}),data:un.Any({description:"数据"}),message:un.String({description:"消息"}),wording:un.String({description:"提示"}),echo:un.Optional(un.String({description:"回显"}))}),Vf=4,Hf=3,Be=5;function Ln(n,e,r=!0,t=new Set,i=0){if(!n)return r?[]:{name:e,type:"unknown",optional:!1};if(i>Vf)return{name:e,type:"object",optional:!1,description:"...",isCircularRef:!0};const a=n.$id;if(a&&t.has(a))return{name:e,type:"object",optional:!1,description:`(${a})`,isCircularRef:!0};const u=new Set(t);a&&u.add(a);const d=n.description,$=!1,h=n.type;if(n.const!==void 0)return{name:e,type:"value",value:n.const,optional:$,description:d};if(n.enum)return{name:e,type:"enum",enum:n.enum,optional:$,description:d};if(n.anyOf||n.oneOf){const O=n.anyOf||n.oneOf,S=O.slice(0,Be).map(N=>Ln(N,void 0,!1,u,i+1));return O.length>Be&&S.push({name:void 0,type:"object",optional:!1,description:`... 还有 ${O.length-Be} 个类型`,isTruncated:!0}),{name:e,type:"union",children:S,optional:$,description:d}}if(n.allOf){const O=n.allOf,A={},S=[];let N=!0;if(O.forEach(D=>{D.type==="object"&&D.properties?(Object.assign(A,D.properties),D.required&&S.push(...D.required)):N=!1}),N)return Ln({...n,type:"object",properties:A,required:S},e,r,u,i);const _=O.slice(0,Be).map(D=>Ln(D,void 0,!1,u,i+1));return{name:e,type:"intersection",children:_,optional:$,description:d}}if(h==="object"){const O=n.properties||{},A=n.required||[],N=Object.keys(O).map(_=>{const D=Ln(O[_],_,!1,u,i+1);return D.optional=!A.includes(_),D});return r?N:{name:e,type:"object",children:N,optional:$,description:d}}if(h==="array"){const O=n.items;if(O){const A=Ln(O,void 0,!1,u,i+1);return{name:e,type:"array",children:[A],optional:$,description:d}}return{name:e,type:"array",children:[],optional:$,description:d}}return h==="string"?{name:e,type:"string",optional:$,description:d}:h==="number"||h==="integer"?{name:e,type:"number",optional:$,description:d}:h==="boolean"?{name:e,type:"boolean",optional:$,description:d}:h==="null"?{name:e,type:"null",optional:$,description:d}:{name:e,type:h||"unknown",optional:$,description:d}}function we(n,e=new Set,r=0){if(!n)return{};if(r>Hf)return null;const t=n.$id;if(t&&e.has(t))return n.type==="array"?[]:n.type==="object"?{}:null;const i=new Set(e);if(t&&i.add(t),n.const!==void 0)return n.const;if(n.default!==void 0)return n.default;if(n.enum)return n.enum[0];if(n.anyOf||n.oneOf){const u=n.anyOf||n.oneOf;return u.find(O=>O.type==="string")?"":u.find(O=>O.type==="number"||O.type==="integer")?0:u.find(O=>O.type==="boolean")?!1:u.length>0?we(u[0],i,r+1):null}const a=n.type;if(a==="object"){const u={},d=n.properties||{},$=n.required||[];for(const h in d)($.includes(h)||r<1)&&(u[h]=we(d[h],i,r+1));return u}return a==="array"?[]:a==="string"?"":a==="number"||a==="integer"?0:a==="boolean"?!1:null}const jt=({type:n,value:e})=>{let r=n;switch(n){case"union":r="联合类型";break;case"value":r="固定值";break}let t="primary";switch(n){case"enum":t="warning";break;case"union":t="secondary";break;case"array":t="primary";break;case"object":t="success";break}return o.jsxs(Fe,{size:"sm",color:t,variant:"flat",children:[r,n==="value"&&o.jsx("span",{className:"px-1 rounded-full bg-primary-400 text-white ml-1",children:e})]})},Oo=({schema:n})=>o.jsxs(o.Fragment,{children:[Array.isArray(n.type)?n.type.map(e=>o.jsx(jt,{type:e,value:n==null?void 0:n.value},e)):o.jsx(jt,{type:n.type,value:n==null?void 0:n.value}),n.optional&&o.jsx(Fe,{size:"sm",color:"default",variant:"flat",children:"可选"}),n.description&&o.jsx("span",{className:"text-xs text-default-400",children:n.description})]}),Fr=({schema:n,children:e})=>{const[r,t]=I.useState(!1),i=()=>t(!r);return o.jsxs("div",{className:"mb-2",children:[o.jsxs("div",{onClick:i,className:"md:cursor-pointer flex items-center gap-1",children:[o.jsx(ut.div,{initial:{rotate:0},animate:{rotate:r?90:0},children:o.jsx(Bo,{})}),o.jsx(_e,{content:"点击复制",placement:"top",showArrow:!0,children:o.jsx("span",{className:"border-b border-transparent border-dashed hover:border-primary-400",onClick:a=>{a.stopPropagation(),navigator.clipboard.writeText(n.name||""),en.success("已复制")},children:n.name})}),o.jsx(Oo,{schema:n})]}),o.jsxs(ut.div,{className:"ml-5 overflow-hidden",initial:{opacity:0,height:0},animate:{opacity:r?1:0,height:r?"auto":0},children:[o.jsx("div",{className:"h-2"}),e]})]})},Je=({schema:n})=>{var e,r;return n.isCircularRef||n.isTruncated?o.jsxs("div",{className:"mb-2 flex items-center gap-1 pl-5",children:[n.name&&o.jsx("span",{className:"text-default-400",children:n.name}),o.jsx(Fe,{size:"sm",color:"default",variant:"flat",children:n.description||"..."})]}):n.type==="object"?o.jsx(Fr,{schema:n,children:n.children&&n.children.length>0?n.children.map((t,i)=>o.jsx(Je,{schema:t},t.name||i)):o.jsx("div",{children:"{}"})}):n.type==="array"||n.type==="union"?o.jsx(Fr,{schema:n,children:(e=n.children)==null?void 0:e.map((t,i)=>o.jsx(Je,{schema:t},t.name||i))}):n.type==="enum"&&Array.isArray(n.enum)?o.jsx(Fr,{schema:n,children:o.jsx("div",{className:"flex gap-1 items-center",children:(r=n.enum)==null?void 0:r.map((t,i)=>o.jsx(Fe,{size:"sm",variant:"flat",color:"success",children:t==null?void 0:t.toString()},(t==null?void 0:t.toString())||i))})}):o.jsxs("div",{className:"mb-2 flex items-center gap-1 pl-5",children:[o.jsx(_e,{content:"点击复制",placement:"top",showArrow:!0,children:o.jsx("span",{className:"border-b border-transparent border-dashed hover:border-primary-400 md:cursor-pointer",onClick:t=>{t.stopPropagation(),navigator.clipboard.writeText(n.name||""),en.success("已复制")},children:n.name})}),o.jsx(Oo,{schema:n})]})},wt=({schema:n})=>o.jsx("div",{className:"",children:Array.isArray(n)?n.map((e,r)=>o.jsx(Je,{schema:e},e.name||r)):o.jsx(Je,{schema:n})}),Wf=I.forwardRef((n,e)=>{const{path:r,data:t,adapterName:i}=n,a=new URL(window.location.origin);a.port="3000";const u=a.href,d=localStorage.getItem("token")||"",[$,h]=De(Ir.httpDebugConfig,{url:u,token:d}),[O,A]=I.useState("{}"),[S,N]=I.useState(""),[_,D]=I.useState(!1),[x,E]=I.useState("request"),[$n,l]=I.useState(!0),[m,y]=I.useState(null),[T,cn]=I.useState(240),[le,Xn]=De("napcat_debug_response_height",240),$o=I.useMemo(()=>{try{return Ln(t==null?void 0:t.payload)}catch(p){return console.error("Error parsing request schema:",p),[]}},[t==null?void 0:t.payload]),go=I.useMemo(()=>{try{const p=un.Object({...qf.properties,data:(t==null?void 0:t.response)||un.Any({description:"数据"})});return Ln(p)}catch(p){return console.error("Error parsing response schema:",p),[]}},[t==null?void 0:t.response]),[jo]=De(Ir.backgroundImage,""),me=!!jo,it=async p=>{if(_)return;D(!0),y(null);const Qn=en.loading("正在发送请求...");try{const Tn=JSON.parse(p??O);if(i){ct.post(`/api/Debug/call/${i}`,{action:r,params:Tn},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(w=>{w.data.code===0?(N(JSON.stringify(w.data.data,null,2)),y({code:200,text:"OK"})):(N(JSON.stringify(w.data,null,2)),y({code:500,text:w.data.message})),l(!0),en.success("请求成功")}).catch(w=>{en.error("请求失败："+w.message),N(JSON.stringify({error:w.message},null,2)),y({code:500,text:"Error"}),l(!0)}).finally(()=>{D(!1),en.dismiss(Qn)});return}const gn=new URL($.url);gn.pathname=r,ct.post(gn.href,Tn,{headers:{Authorization:`Bearer ${$.token}`}}).then(w=>{N(JSON.stringify(w.data,null,2)),y({code:w.status,text:w.statusText}),l(!0),en.success("请求成功")}).catch(w=>{var pn;en.error("请求失败："+w.message),N(JSON.stringify(((pn=w.response)==null?void 0:pn.data)||{error:w.message},null,2)),w.response&&y({code:w.response.status,text:w.response.statusText}),l(!0)}).finally(()=>{D(!1),en.dismiss(Qn)})}catch{en.error("请求体 JSON 格式错误"),D(!1),en.dismiss(Qn)}};I.useImperativeHandle(e,()=>({setRequestBody:p=>{E("request"),A(p)},sendWithBody:p=>{E("request"),A(p),it(p)},focusRequestEditor:()=>{E("request")}})),I.useEffect(()=>{if(t!=null&&t.payloadExample)A(JSON.stringify(t.payloadExample,null,2));else try{A(JSON.stringify(we(t==null?void 0:t.payload),null,2))}catch(p){console.error("Error generating default:",p),A("{}")}N(""),y(null)},[r]),I.useEffect(()=>{cn(le)},[]);const wo=I.useCallback(p=>{p.preventDefault();const Qn=p.clientY,Tn=T;let gn=Tn,w;const pn=Le=>{w&&cancelAnimationFrame(w),w=requestAnimationFrame(()=>{const xr=Qn-Le.clientY;gn=Math.max(100,Math.min(window.innerHeight-200,Tn+xr)),cn(gn)})},pe=()=>{document.removeEventListener("mousemove",pn),document.removeEventListener("mouseup",pe),w&&cancelAnimationFrame(w),Xn(gn)};document.addEventListener("mousemove",pn),document.addEventListener("mouseup",pe)},[T,Xn]),ho=I.useCallback(p=>{const Tn=p.touches[0].clientY,gn=T;let w=gn,pn;const pe=xr=>{pn&&cancelAnimationFrame(pn),pn=requestAnimationFrame(()=>{const Ro=xr.touches[0],No=Tn-Ro.clientY;w=Math.max(100,Math.min(window.innerHeight-200,gn+No)),cn(w)})},Le=()=>{document.removeEventListener("touchmove",pe),document.removeEventListener("touchend",Le),pn&&cancelAnimationFrame(pn),Xn(w)};document.addEventListener("touchmove",pe),document.addEventListener("touchend",Le)},[T,Xn]);return o.jsxs("div",{className:"flex flex-col h-full w-full relative overflow-hidden",children:[o.jsxs("div",{className:H("flex items-center gap-4 px-4 py-2 border-b flex-shrink-0 z-10",me?"border-white/10 bg-white/5":"border-black/5 dark:border-white/10 bg-white/40 dark:bg-black/20"),children:[o.jsx("div",{className:"flex items-center gap-3 flex-1 min-w-0 pl-1",children:o.jsx("div",{className:H("text-sm font-mono truncate select-all px-2 py-1 rounded-md transition-colors",me?"text-white/90 bg-black/10":"text-foreground dark:text-white/90 bg-default-100/50"),children:r})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs(qo,{placement:"bottom-end",backdrop:"transparent",children:[o.jsx(Vo,{children:o.jsx(jn,{size:"sm",variant:"light",radius:"sm",isIconOnly:!0,className:"opacity-60 hover:opacity-100",children:o.jsx(Uo,{className:"text-lg"})})}),o.jsx(Ho,{className:"w-[260px] p-3 rounded-md border border-white/10 shadow-2xl bg-white/80 dark:bg-black/80 backdrop-blur-xl",children:o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("p",{className:"text-[10px] font-bold opacity-30 uppercase tracking-widest",children:"Debug Setup"}),o.jsx(yr,{label:"Base URL",labelPlacement:"outside",placeholder:"http://...",value:$.url,onChange:p=>h({...$,url:p.target.value}),size:"sm",variant:"bordered"}),o.jsx(yr,{label:"Token",labelPlacement:"outside",placeholder:"access_token",value:$.token,onChange:p=>h({...$,token:p.target.value}),size:"sm",variant:"bordered"})]})})]}),o.jsx(jn,{onPress:()=>it(),color:"primary",radius:"sm",size:"sm",className:"font-bold shadow-sm px-4",isLoading:_,startContent:!_&&o.jsx(ko,{className:"text-xs"}),children:"发送"})]})]}),o.jsx("div",{className:"flex-1 min-h-0 flex flex-col relative",children:o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[o.jsxs("div",{className:H("px-4 flex items-center justify-between h-10 flex-shrink-0 border-b",me?"border-white/10":"border-default-100 dark:border-white/10"),children:[o.jsxs(Wo,{"aria-label":"Request Options",size:"sm",variant:"underlined",selectedKey:x,onSelectionChange:E,classNames:{tabList:"p-0 gap-6 bg-transparent",cursor:"w-full bg-foreground dark:bg-white h-[2px]",tab:"px-0 h-full",tabContent:"text-xs font-medium text-default-500 dark:text-white/50 group-data-[selected=true]:text-foreground dark:group-data-[selected=true]:text-white"},children:[o.jsx(ft,{title:"请求体"},"request"),o.jsx(ft,{title:"接口文档"},"docs")]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-70",children:[o.jsx(Jo,{children:p=>o.jsx(_e,{content:"构造 CQ 码",closeDelay:0,children:o.jsx(jn,{isIconOnly:!0,size:"sm",variant:"light",radius:"sm",className:"w-8 h-8",onPress:p,children:o.jsx(Do,{size:16})})})}),o.jsx(_e,{content:"生成示例",closeDelay:0,children:o.jsx(jn,{isIconOnly:!0,size:"sm",variant:"light",radius:"sm",className:"w-8 h-8",onPress:()=>{try{A(JSON.stringify(we(t==null?void 0:t.payload),null,2))}catch(p){console.error("Error generating default:",p),en.error("生成示例失败")}},children:o.jsx(zo,{size:16})})})]})]}),o.jsx("div",{className:"flex-1 relative overflow-hidden",children:x==="request"?o.jsx("div",{className:"absolute inset-0",children:o.jsx(at,{value:O,onChange:p=>A(p??""),language:"json",options:{minimap:{enabled:!1},fontSize:13,fontFamily:"JetBrains Mono, monospace",scrollBeyondLastLine:!1,wordWrap:"on",padding:{top:16,bottom:16},lineNumbersMinChars:3,chromeless:!0,backgroundColor:"transparent"}})}):o.jsxs("div",{className:"p-6 space-y-8 overflow-y-auto h-full scrollbar-hide",children:[o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-bold text-default-700 dark:text-default-50 uppercase tracking-widest mb-4",children:"Request Params"}),o.jsx(wt,{schema:$o})]}),o.jsx("div",{className:"h-px bg-white/10 w-full"}),o.jsxs("section",{children:[o.jsx("h3",{className:"text-[10px] font-bold text-default-700 dark:text-default-50 uppercase tracking-widest mb-4",children:"Response Data"}),o.jsx(wt,{schema:go})]})]})})]})}),o.jsxs("div",{className:"flex-shrink-0 flex flex-col overflow-hidden relative",style:{height:$n?void 0:"auto"},children:[o.jsxs("div",{className:H("flex items-center justify-between px-4 py-1.5 cursor-pointer hover:bg-black/5 dark:hover:bg-white/5 transition-colors select-none group relative border-t",me?"border-white/10":"border-default-100 dark:border-white/10"),onClick:()=>l(!$n),children:[$n&&o.jsx("div",{className:"absolute -top-1.5 left-0 w-full h-4 cursor-ns-resize z-20",onMouseDown:p=>{p.stopPropagation(),wo(p)},onTouchStart:p=>{p.stopPropagation(),ho(p)},onClick:p=>p.stopPropagation()}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:H("transition-transform duration-200",!$n&&"-rotate-90"),children:o.jsx(Mo,{size:14,className:"opacity-50"})}),o.jsx("span",{className:H("text-[10px] font-bold tracking-widest uppercase",me?"text-white":"text-foreground dark:text-white"),children:"Response"}),m&&o.jsxs(Fe,{size:"sm",variant:"dot",color:m.code>=200&&m.code<300?"success":"danger",className:"h-5 text-[10px] font-mono border-none bg-transparent pl-0",children:[m.code," ",m.text]})]}),o.jsx(jn,{size:"sm",variant:"light",isIconOnly:!0,radius:"sm",className:"h-6 w-6 opacity-40 hover:opacity-100",onClick:p=>{p.stopPropagation(),navigator.clipboard.writeText(S),en.success("已复制")},children:o.jsx(Lo,{size:12})})]}),$n&&o.jsxs("div",{style:{height:T},className:"relative bg-transparent",children:[o.jsx(To,{loading:_}),o.jsx("div",{className:"absolute inset-0",children:o.jsx(at,{value:S||"// Waiting for response...",language:"json",options:{minimap:{enabled:!1},fontSize:12,fontFamily:"JetBrains Mono, monospace",lineNumbers:"off",scrollBeyondLastLine:!1,wordWrap:"on",readOnly:!0,folding:!0,padding:{top:12,bottom:12},renderLineHighlight:"none",chromeless:!0,backgroundColor:"transparent"}})})]})]})]})}),Jf=()=>{try{return window.innerWidth<768}catch{return!1}};function Gf(n){const{isOpen:e,onOpenChange:r,commands:t,onExecute:i}=n,a=I.useRef(null),[u,d]=I.useState(""),[$,h]=I.useState(0),[O,A]=I.useState(!1);I.useEffect(()=>{const x=()=>A(Jf());return x(),window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),I.useEffect(()=>{if(!e)return;d(""),h(0);const x=window.setTimeout(()=>{var E;return(E=a.current)==null?void 0:E.focus()},50);return()=>window.clearTimeout(x)},[e]);const S=I.useMemo(()=>{const x=u.trim().toLowerCase(),E=x?t.filter(m=>`${m.id} ${m.title} ${m.subtitle??""} ${m.group??""}`.toLowerCase().includes(x)):t;if(!x)return E;const $n=E.filter(m=>m.id.toLowerCase().startsWith(x)),l=E.filter(m=>!m.id.toLowerCase().startsWith(x));return[...$n,...l]},[t,u]);I.useEffect(()=>{$>=S.length&&h(0)},[S.length,$]);const N=S[$],_=x=>{N&&(i(N.id,x),r(!1))},D=x=>{if(x.key==="ArrowDown"){x.preventDefault(),h(E=>Math.min(E+1,Math.max(0,S.length-1)));return}if(x.key==="ArrowUp"){x.preventDefault(),h(E=>Math.max(E-1,0));return}if(x.key==="Enter"){x.preventDefault(),_(x.shiftKey?"open":"send");return}x.key==="Escape"&&(x.preventDefault(),r(!1))};return o.jsx(Po,{isOpen:e,onOpenChange:r,size:O?"full":"2xl",radius:O?"none":"lg",scrollBehavior:"inside",backdrop:"blur",children:o.jsx(Ao,{children:()=>o.jsxs(o.Fragment,{children:[o.jsxs(So,{className:H("flex items-center gap-2",O?"border-b border-default-200/50":""),children:[o.jsx("span",{className:"text-sm font-semibold",children:"命令面板"}),o.jsx("span",{className:"text-xs text-default-400 font-normal hidden md:inline",children:"Ctrl/Cmd + K"})]}),o.jsxs(Eo,{className:H("gap-3",O?"p-3":"p-4"),children:[o.jsx(yr,{ref:a,autoFocus:!0,value:u,onValueChange:d,onKeyDown:D,placeholder:"输入 /set_xxx 或 描述…  Enter：打开并发送，Shift+Enter：仅打开",startContent:o.jsx(ht,{className:"opacity-40",size:16}),radius:"lg",variant:"flat",classNames:{inputWrapper:"bg-content2/50 border border-default-200/50 dark:border-default-100/20",input:"text-sm"}}),o.jsx("div",{className:H("rounded-xl border border-default-200/50 dark:border-default-100/20 overflow-hidden",O?"flex-1 min-h-0":"max-h-[420px]"),children:o.jsxs("div",{className:H("divide-y divide-default-200/50 dark:divide-default-100/20 overflow-y-auto no-scrollbar",O?"h-full":"max-h-[420px]"),children:[S.length===0&&o.jsx("div",{className:"p-6 text-sm text-default-400",children:"没有匹配的接口"}),S.map((x,E)=>o.jsxs("button",{type:"button",className:H("w-full text-left px-4 py-3 transition-colors flex items-center gap-3",E===$?"bg-primary/10":"hover:bg-default-100/50 dark:hover:bg-default-50/10"),onMouseEnter:()=>h(E),onClick:()=>{h(E),_("open")},children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[o.jsx("span",{className:"text-xs font-mono text-default-500 truncate",children:x.id}),x.group&&o.jsx("span",{className:"text-[10px] px-2 py-0.5 rounded-full bg-default-100/60 dark:bg-default-50/20 text-default-500",children:x.group})]}),o.jsx("div",{className:"text-sm text-default-700 dark:text-default-200 truncate",children:x.title}),x.subtitle&&o.jsx("div",{className:"text-xs text-default-400 truncate",children:x.subtitle})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[o.jsx("span",{className:"hidden md:inline text-[10px] text-default-400",children:"Enter"}),o.jsx(_o,{className:"opacity-40",size:16})]})]},x.id))]})})]}),O&&o.jsxs(Co,{className:"border-t border-default-200/50",children:[o.jsx(jn,{radius:"full",variant:"flat",onPress:()=>r(!1),children:"取消"}),o.jsx(jn,{radius:"full",variant:"flat",color:"primary",isDisabled:!N,onPress:()=>_("open"),children:"打开"}),o.jsx(jn,{radius:"full",color:"primary",isDisabled:!N,onPress:()=>_("send"),children:"打开并发送"})]})]})})})}function Rd(){const[n,e]=I.useState(null),[r,t]=I.useState([]),[i,a]=I.useState({}),[u]=De(Ir.backgroundImage,""),d=!!u,[$,h]=I.useState(""),[O,A]=I.useState(!1),S=I.useRef(new Map),[N,_]=I.useState(null);I.useEffect(()=>{const l=m=>{(m.ctrlKey||m.metaKey)&&m.key.toLowerCase()==="k"&&(m.preventDefault(),A(!0))};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]),I.useEffect(()=>{let l="";return(async()=>{try{const[y]=await Promise.all([Go(),fetch("/api/Debug/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(T=>T.json()).then(T=>{T.code===0&&(l=T.data.adapterName,h(l))})]);a(y)}catch(y){console.error("Failed to initialize debug:",y)}})(),()=>{}},[]);const D=l=>{r.includes(l)||t([...r,l]),e(l)};I.useEffect(()=>{if(!N||n!==N.path)return;const l=S.current.get(N.path);l&&(l.sendWithBody(N.body),_(null))},[n,N]);const x=I.useMemo(()=>Object.keys(i).map(l=>{const m=l,y=i[m],T="/"+m,cn=m.startsWith("get_")?"GET":m.startsWith("set_")?"SET":"API";return{id:m,title:(y==null?void 0:y.description)||T,subtitle:y!=null&&y.payload?"回车发送 · Shift+Enter 仅打开":void 0,group:cn}}),[i]),E=(l,m)=>{const y=l,T=i[y];let cn="{}";if(T!=null&&T.payloadExample)cn=JSON.stringify(T.payloadExample,null,2);else if(T!=null&&T.payload)try{cn=JSON.stringify(we(T.payload),null,2)}catch(Xn){console.error("Error generating default:",Xn),cn="{}"}D(y);const le=S.current.get(y);if(le){m==="send"?le.sendWithBody(cn):le.setRequestBody(cn);return}m==="send"&&_({path:y,body:cn})},$n=(l,m)=>{l.stopPropagation();const y=r.filter(T=>T!==m);t(y),n===m&&(y.length>0?e(y[y.length-1]):e(null))};return o.jsxs(o.Fragment,{children:[o.jsx("title",{children:"HTTP调试 - NapCat WebUI"}),o.jsx("div",{className:"h-[calc(100vh-3.5rem)] pt-2 px-0 md:px-4",children:o.jsx("div",{className:H("h-full flex flex-col overflow-hidden transition-all relative","bg-transparent"),children:o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden relative",children:[o.jsxs("div",{className:H("flex items-center w-full flex-shrink-0 pr-2 md:pl-4 py-1 relative z-20 rounded-md",d?"bg-white/5":"bg-white/30 dark:bg-white/5"),children:[o.jsx("div",{className:"flex-1 overflow-x-auto no-scrollbar flex items-center",children:r.map(l=>{const m=l===n,y=i[l];return o.jsxs("div",{onClick:()=>e(l),className:H("group flex items-center gap-2 px-3 h-8 my-1 mr-1 rounded-md cursor-pointer border select-none transition-all min-w-[120px] max-w-[260px]",d?"border-transparent hover:bg-white/10":"border-transparent hover:bg-white/10 dark:hover:bg-white/5",m?d?"bg-white/15 text-white border-white/20":"bg-default-100 dark:bg-white/15 text-foreground dark:text-white font-medium shadow-sm border-default-200 dark:border-white/10":d?"text-white/70 hover:text-white":"text-default-600 dark:text-white/70 hover:text-default-900 dark:hover:text-white"),children:[o.jsx("span",{className:H("text-[10px] font-bold uppercase tracking-wider px-1.5 py-0.5 rounded-sm",m?"bg-success/20 text-success":"opacity-60 bg-default-200/50 dark:bg-white/10"),children:"POST"}),o.jsx("span",{className:"text-xs truncate flex-1",children:(y==null?void 0:y.description)||l}),o.jsx("div",{className:H("p-0.5 rounded-sm hover:bg-black/10 dark:hover:bg-white/20 transition-opacity",m?"opacity-40 hover:opacity-100":"opacity-0 group-hover:opacity-40"),onClick:T=>$n(T,l),children:o.jsx(Ko,{size:12})})]},l)})}),o.jsx("div",{className:"flex items-center gap-2 pl-2 border-l border-white/5 flex-shrink-0",children:o.jsx(jn,{isIconOnly:!0,size:"sm",radius:"sm",variant:"light",className:"text-default-500 hover:text-primary w-10 h-10 min-w-10",onClick:()=>A(!0),onPress:()=>A(!0),children:o.jsx(ht,{size:18})})})]}),o.jsxs("div",{className:"flex-1 relative overflow-hidden",children:[n===null&&o.jsx("div",{className:"h-full flex items-center justify-center text-default-400 text-sm opacity-50 select-none",children:"使用命令面板选择接口（Ctrl/Cmd + K）"}),r.map(l=>o.jsx("div",{className:H("h-full w-full absolute top-0 left-0 transition-opacity duration-200",l===n?"opacity-100 z-10":"opacity-0 z-0 pointer-events-none"),children:o.jsx(Wf,{ref:m=>{if(!m){S.current.delete(l);return}S.current.set(l,m)},path:l,data:i[l],adapterName:$})},l))]})]})})}),o.jsx(Gf,{isOpen:O,onOpenChange:A,commands:x,onExecute:E})]})}export{Rd as default};
